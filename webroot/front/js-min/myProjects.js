$(document).ready(function(){window.rate=0;const t=$(".panel-heading").width();$(".panel-body").css("width",t-95),moment.locale("pt-br"),$('a[data-toggle="pill"]').on("shown.bs.tab",function(t){const e=".date-end",a="DD/MM/YYYY",o=$($(t.target).attr("href"));if($(t.target).attr("href").match(/prazo/)){const s=moment(o.find(e).text(),a),n=moment(moment().format(a),a),r=n.diff(s,"days"),i=r>0?r:r*-1,c=n>s?"subtract":"add",l="add"==c?"será ":"foi ";o.find(e).text(null).append(l+"<b>"+moment()[c](i,"days").calendar().toLowerCase()+"</b>")}}),$(".escolho-voce").on("click",function(){const t=webroot+"projects/fix-user-project",e={project:$(this).data("project"),user:$(this).data("user"),userName:$(this).data("user_name")};$.post(t,e,function(t){"success"===t.result.status?($("#collapse"+e.project).find(".user-"+e.user).addClass("fixed"),$(this).html('<i class="fa fa-check-circle"></i> '+e.userName.toUpperCase()+" FOI ESCOLHIDO").addClass("white"),Messenger().post({message:t.result.data,type:"success",showCloseButton:!0})):Messenger().post({message:t.result.data,type:"error",showCloseButton:!0})}.bind(this),"json")}),$(".open-partner").on("click",function(){var t=webroot+"projects/show-partner",e=$(".project-window-"+$(this).data("project"));e.toggleClass("open");var a=$(this).data("dev").split("-"),o={id:a[0]},s="contractor"==a[1]?"Contratante":"Freelancer";$.post(t,o,function(t){if("success"===t.result.status){null!==t.result.data.picture&&e.find("img").attr("src",t.result.data.picture),e.find(".name").text(t.result.data.name),e.find(".created").text(s+" desde "+t.result.data.created),e.find(".finished").html("Projeto finalizados: <span>"+t.result.data.finished+"</span>");var a=e.find("button");a.on("click",function(){window.location.href=webroot+"visualizar-perfil/"+t.result.data.id})}},"json")}),$(".star-input").change(function(){var t=$(this);const e={1:"Péssimo :´(",2:"Ruim :(",3:"Regular :l",4:"Bom :)",5:"Ótimo :D"};window.rate=t.attr("value"),$(".rate").text(e[t.attr("value")])}),$(".open-modal-reputation").on("click",function(t){$("#reputation-"+$(this).data("project")).modal("show")}),$(".avaliarContratante").on("click",function(){var t=webroot+"projects/avaliate-contractor",e={project_id:$(this).data("project"),user_id:$(this).data("contractor"),avaliation:$(".avaliation-freelancer-"+$(this).data("project")).val()};$.post(t,e,function(t){"success"==t.result.status&&(Messenger().post({message:"Contratante avaliado com sucesso !",type:"success",showCloseButton:!0}),setTimeout(function(){location.reload()},1e3))},"json")}),$(".finishProject").on("click",function(t){const e=webroot+"projects/finish-project",a=$(this).data("project"),o={project:a,rate:window.rate,avaliation:$(".avaliation-"+$(this).data("project")).val()};$.post(e,o,function(t){"success"==t.result.status?(Messenger().post({message:"Freelancer avaliado com "+window.rate+" estrelas!",type:"success",showCloseButton:!0}),location.reload()):Messenger().post({message:"Não foi possível avaliar o freelancer",type:"error",showCloseButton:!0}),$("#reputation-"+a).modal("hide")},"json")}),$(".open-anexo").click(function(){$("#project-file-"+$(this).data("project")).modal("show")})});